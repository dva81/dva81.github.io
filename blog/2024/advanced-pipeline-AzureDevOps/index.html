<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>An advanced pipeline in Azure DevOps and GITHUB for Power Platform Solutions | Dennis Van Aelst</title> <meta name="author" content="Dennis Van Aelst"/> <meta name="description" content="This time I will show you two advanced pipeline to export and import a Power Platform solution with a GITHUB connection. The thought behind this is that the highly regulated enterprises have more complex working environments and deployment needs."/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://dva81.github.io/blog/2024/advanced-pipeline-AzureDevOps/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js?3dd82e91913a2c1265c0f80e41ff39e2"></script> <script src="/assets/js/dark_mode.js?6458e63976eae16c0cbe86b97023895a"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Dennis </span>Van Aelst</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">An advanced pipeline in Azure DevOps and GITHUB for Power Platform Solutions</h1> <p class="post-meta">July 19, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/category/PowerPlatform"> <i class="fas fa-tag fa-sm"></i> PowerPlatform</a>   <a href="/blog/category/AI"> <i class="fas fa-tag fa-sm"></i> AI</a>   <a href="/blog/category/DevOps"> <i class="fas fa-tag fa-sm"></i> DevOps</a>   <a href="/blog/category/Copilot"> <i class="fas fa-tag fa-sm"></i> Copilot</a>   </p> </header> <article class="post-content"> <p>When working with many developers or designers in highly secure environment with a lot of compliance rules and regulations, Power Platform can be challenging to maintain. In this <a href="https://www.linkedin.com/pulse/azure-devops-easily-deploy-power-platform-solution-dennis-van-aelst-mzfpe/?trackingId=Zt9plSeCTg2OyehjOFpuog%3D%3D" target="_blank" rel="noopener noreferrer">Azure DevOps: Easily deploy a Power platform solution - LinkedIn</a> article, I gave an example on how to create a simple DevOps pipeline.</p> <p>This time I will show you two advanced pipeline to export and import a Power Platform solution with a GITHUB connection. The thought behind this is that the highly regulated enterprises have more complex working environments and deployment needs.</p> <ul> <li>Many developers are working on the same solution in different development environments.</li> <li>Code or configuration check must be done before deploying preferably automated</li> <li>Branching and merging policies.</li> <li>Standard configurations must be added automatically after development</li> </ul> <h1 id="setting-the-stage">Setting the stage</h1> <p>We will be using the following components.</p> <ul> <li>Azure DevOps environment for the build and release pipelines</li> <li>GITHUB repository for storing the configuration and merging the different brances</li> <li>Power Platform environment with a solution to export</li> </ul> <p>The example will be importing from only one environment but it can be extended if needed. If you are reading this article, I can safely assume you know your way around Microsoft Power Platform. However source control is not always related to low code so if you are new to GITHUB check out this Beginner’s guide to GitHub repositories: <a href="https://github.blog/2024-06-24-beginners-guide-to-github-repositories-how-to-create-your-first-repo/" target="_blank" rel="noopener noreferrer">How to create your first repo - The GitHub Blog</a></p> <h1 id="build">Build</h1> <p>There are two pipelines. Get the Solution and Pack and drop.</p> <p><img src="https://github.com/user-attachments/assets/5dd9d6ee-4239-458a-a15f-5a0e658ed683" alt="Build"></p> <h2 id="get-the-solution">Get the Solution</h2> <p>The goal is to export the solution from the Power Platform environment and store the configuration in GITHUB under a new branch.</p> <p><img src="https://github.com/user-attachments/assets/1ca58311-b0c7-4854-a3b3-99b42f81540f" alt="Get the Solution"></p> <p>The first three jobs are simple but before those start the Checkout – job creates / clones the Github repo on the agent. This way we can use that location to clean the repository before unpacking the solution in that location.</p> <p><img src="https://github.com/user-attachments/assets/48762fd5-985f-4876-a374-871ae7cd5893" alt="Checkout"></p> <p>In the Clean repo step, The GIT rm command is used to remove the old configuration making it ready to accept the new incoming.</p> <p><img src="https://github.com/user-attachments/assets/801024a4-f39b-4178-bbdc-bca224ed6750" alt="Clean"></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>write-host "Set location"
Set-Location -Path $(Build.Repository.LocalPath)

write-host "Start GIT Stuff"
git config user.email "$(Build.RequestedForEmail)"
git config user.name $(Build.RequestedForId)

write-host "Switch"
git switch -c $(Build.BuildId)
</code></pre></div></div> <table> <tbody> <tr> <td>After unpacking, we can send the files to GITHUB in a new branch. I am using predefined variables [Predefined variables - Azure Pipelines</td> <td>Microsoft Learn](https://learn.microsoft.com/en-us/azure/devops/pipelines/build/variables?view=azure-devops&amp;tabs=yaml#identity_values) because I like standard basic things.</td> </tr> </tbody> </table> <p><img src="https://github.com/user-attachments/assets/18453d97-84e8-4584-9471-6ad541149368" alt="unpacking"></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>write-host "Set location"
Set-Location -Path $(Build.Repository.LocalPath)

write-host "Start GIT Stuff"
git config user.email "$(Build.RequestedForEmail)"
git config user.name $(Build.RequestedForId)

write-host "Switch"
git switch -c $(Build.BuildId)
# git checkout -b $(Build.BuildId)

write-host "Adding"
git status
git add *

write-host "Commit"
git commit -m "$(Build.SourceVersionMessage)"
git status

write-host "Push code to new repo"
git -c http.extraheader="AUTHORIZATION: bearer $(System.AccessToken)" push origin $(Build.BuildId)
git status
</code></pre></div></div> <h2 id="things-did-not-go-as-planned">Things did not go as planned</h2> <p>Some things took more time than others. These types configuration of things are an intricate maze of tools, tasks and settings.</p> <p><strong>The Git push did not work</strong> The Git push did not work and I got a message the “authentication was not done properly”. I missed a setting in the Agent Job. <a href="https://stackoverflow.com/questions/64803872/azure-pipeline-cannot-prompt-because-terminal-prompts-have-been-disabled" target="_blank" rel="noopener noreferrer">git - Azure Pipeline, Cannot prompt because terminal prompts have been disabled - Stack Overflow</a></p> <p><img src="https://github.com/user-attachments/assets/35fb26fc-d67a-4037-aab1-64c95ce31b3f" alt="push"></p> <p><strong>Error Not a repo</strong> This was because I cleaned the repo before filling it again. I solved this with the GIT rm command. Which did not destroy the cloned repo. <a href="https://komodor.com/blog/solving-fatal-not-a-git-repository-error/" target="_blank" rel="noopener noreferrer">Solved: fatal: Not a git repository (or any of the parent directories): .git (komodor.com)</a></p> <p><strong>Unpack vs unzip does not make a difference.</strong> What is strange is that the [Content_types].xml is not extracted in both cases and files in the root are placed in the folder ‘other’. I lost some figering this out. However after packing the Solution, it does create the correct structure again…</p> <p><img src="https://github.com/user-attachments/assets/36170d33-3513-4a48-965a-6a25f9335d15" alt="Unpack"></p> <p><img src="https://github.com/user-attachments/assets/9ff41786-dcf3-49e2-809f-e3929c48a452" alt="Unpack"></p> <p><img src="https://github.com/user-attachments/assets/0f476b28-d247-44d9-babf-87d688717027" alt="Unpack"></p> <h1 id="pack-and-drop">Pack and drop</h1> <p>This pipeline gets the configuration items from the GITHUB repo and packs the Solution again to a managed solution. out of the box you cannot pack from unmanaged to managed and visa versa. The result is a deployable artifact that can be released to any environment. I did not show the deployment settings in the example. Check out my other article for that. You will need to incorporate all connections references and other dependancies like custom connectors.</p> <p><img src="https://github.com/user-attachments/assets/e500ec17-0284-4b47-8b32-3191725d0e80" alt="Pack and drop"></p> <h1 id="release-pipelines">Release pipelines</h1> <p>The release pipeline is easy. We are working with managed solutions. Unmanaged is not advised! Microsoft considers these as still under development, and you can import or export as unmanaged. You can modify unmanaged solutions. Managed solutions are complete solutions ready for distribution that you cannot modify after importing them to the selected environment. These solutions are intended for production environments. More info on: <a href="https://learn.microsoft.com/en-us/power-apps/maker/data-platform/solution-layers" target="_blank" rel="noopener noreferrer">Solution layers - Power Apps | Microsoft Learn</a></p> <p><img src="https://github.com/user-attachments/assets/2b2f9846-aa55-40f3-9ad2-734128707a09" alt="pipelines"></p> <p>By using the managed solution all your environments stay nice and clean.</p> <p>Here is an example of a multi stage environment. You can even make this dynamic if you incorporate pipelines and scripts for environment provisioning and use the API for Azure DevOps to automatically create pipelines and release configurations.</p> <p><img src="https://github.com/user-attachments/assets/0f0f5ffb-4e73-4699-88bd-7f27542f00d6" alt="release"></p> <h1 id="a-parting-note">A parting note</h1> <p>This way method provides a way to introduce all capabilities of modern version control on all aspects of a Power Platform solution. Beware though. You are merging configurations, not real code. The syntax may be ok but that does not mean it will work! The Power Platform is not really intended to use this way. So be carefull!</p> <p>My focus is on structuring, automating and managing business processes using Agile and DevOps best practices. This creates working environments where business continuity, transparency and human capital come first. Reach out to me on <a href="https://www.linkedin.com/in/dennisvanaelst" target="_blank" rel="noopener noreferrer">LinkedIn</a> or check out my <a href="https://github.com/dva81" target="_blank" rel="noopener noreferrer">github</a> or <a href="https://www.dennisvanaelst.net/" target="_blank" rel="noopener noreferrer">blog</a> for more tips and tricks.</p> <hr> <p>The ideas and underlying essence are original and generated by a human author. The organization, grammar, and presentation may have been enhanced by the use of AI.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Dennis Van Aelst. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-RQSSYLRG0H"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RQSSYLRG0H");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>